# -----------------------------
# Part (a) Logistic Regression
# -----------------------------

# Load required packages
require(foreign)
require(MASS)

# Import data from web
# Using the classic "admission" dataset from UCLA (publicly available)
admission_data <- read.csv("https://stats.idre.ucla.edu/stat/data/binary.csv")

# View first few rows
head(admission_data)

# Rename columns for clarity
colnames(admission_data) <- c("admit", "GRE", "GPA", "Rank")

# Convert 'Rank' into factor (categorical)
admission_data$Rank <- as.factor(admission_data$Rank)

# Build logistic regression model
model <- glm(admit ~ GRE + GPA + Rank, data = admission_data, family = "binomial")

# Display model summary
summary(model)

# Check if the model is a good fit
# Null deviance vs Residual deviance
cat("\nModel Fit Check:\n")
cat("Null Deviance: ", model$null.deviance, "\n")
cat("Residual Deviance: ", model$deviance, "\n")

# Lower residual deviance indicates better fit

# Predict probability of admission
predicted_prob <- predict(model, type = "response")

# Convert probabilities to binary outcome (0 or 1)
predicted_admit <- ifelse(predicted_prob > 0.5, 1, 0)

# Confusion matrix
table(Predicted = predicted_admit, Actual = admission_data$admit)

# Calculate accuracy
accuracy <- mean(predicted_admit == admission_data$admit)
cat("\nModel Accuracy:", accuracy)
